(function(f){function gb(a,b){b.unbind(ha);b.bind(ha,function(c,d,e){typeof a.callback.nodeCreated=="function"&&a.callback.nodeCreated(c,d,e)});b.unbind(ia);b.bind(ia,function(c,d,e){typeof a.callback.click=="function"&&a.callback.click(c,d,e)});b.unbind(ja);b.bind(ja,function(c,d,e){typeof a.callback.change=="function"&&a.callback.change(c,d,e)});b.unbind(Y);b.bind(Y,function(c,d,e){typeof a.callback.rename=="function"&&a.callback.rename(c,d,e)});b.unbind(ka);b.bind(ka,function(c,d,e){typeof a.callback.remove==
"function"&&a.callback.remove(c,d,e)});b.unbind(la);b.bind(la,function(c,d,e){typeof a.callback.drag=="function"&&a.callback.drag(c,d,e)});b.unbind(Z);b.bind(Z,function(c,d,e,g,i){typeof a.callback.drop=="function"&&a.callback.drop(c,d,e,g,i)});b.unbind(ma);b.bind(ma,function(c,d,e){typeof a.callback.expand=="function"&&a.callback.expand(c,d,e)});b.unbind(na);b.bind(na,function(c,d,e){typeof a.callback.collapse=="function"&&a.callback.collapse(c,d,e)});b.unbind(oa);b.bind(oa,function(c,d,e,g){typeof a.callback.asyncSuccess==
"function"&&a.callback.asyncSuccess(c,d,e,g)});b.unbind(pa);b.bind(pa,function(c,d,e,g,i,j){typeof a.callback.asyncError=="function"&&a.callback.asyncError(c,d,e,g,i,j)});a.treeObj.bind("contextmenu",function(c){var d=f(c.target);d=qa(a,d);var e=true;if(typeof a.callback.beforeRightClick=="function")e=a.callback.beforeRightClick(a.treeObjId,d);if(e&&typeof a.callback.rightClick=="function"){a.callback.rightClick(c,a.treeObjId,d);return false}return typeof a.callback.rightClick!="function"});a.treeObj.bind("mouseup",
function(c){var d=f(c.target);d=qa(a,d);var e=true;if(typeof a.callback.beforeMouseUp=="function")e=a.callback.beforeMouseUp(a.treeObjId,d);e&&typeof a.callback.mouseUp=="function"&&a.callback.mouseUp(c,a.treeObjId,d);return true});a.treeObj.bind("mousedown",function(c){var d=f(c.target);d=qa(a,d);var e=true;if(typeof a.callback.beforeMouseDown=="function")e=a.callback.beforeMouseDown(a.treeObjId,d);e&&typeof a.callback.mouseDown=="function"&&a.callback.mouseDown(c,a.treeObjId,d);return true})}function qa(a,
b){var c;c=f(b);if(c.attr("id")==a.treeObjId)c=null;else{for(;!c.is("li")&&c.attr("id")!=a.treeObjId;)c=c.parent();c=c.attr("id");c=T(a,c)}return c}function U(a,b,c,d){if(c)for(var e=0;e<c.length;e++){var g=c[e];g.level=b;g.tId=a.treeObjId+"_"+ ++ra;g.parentNode=d;g[a.checkedCol]=g[a.checkedCol]==true;g.checkedOld=g[a.checkedCol];g.check_Focus=false;g.check_True_Full=true;g.check_False_Full=true;g.editNameStatus=false;Ja(a,g);g.isFirstNode=(d?d:a.root)[a.nodesCol].length==c.length&&e==0;g.isLastNode=
e==c.length-1;if(g[a.nodesCol]&&g[a.nodesCol].length>0){g.open=g.open?true:false;g.isParent=true;Ka(a,g);U(a,b+1,g[a.nodesCol],g)}else{g.isParent=g.isParent?true:false;Ka(a,g)}}}function Ka(a,b){var c=b.parentNode;c=c?f("#"+b.parentNode.tId+v):a.treeObj;c.append("<li id='"+b.tId+"' class='tree-node'><button type=\"button\" id='"+b.tId+z+"' title='' onfocus='this.blur();'></button><a id='"+b.tId+n+"' onclick=\""+(b.click||"")+'" ><button type="button" id=\''+b.tId+t+"' title='' onfocus='this.blur();'></button><span id='"+
b.tId+K+"'></span></a><ul id='"+b.tId+v+"'></ul></li>");c=f("#"+b.tId+z);var d=f("#"+b.tId+n);f("#"+b.tId+K);var e=f("#"+b.tId+v),g=f("#"+b.tId+t);La(a,b);F(a,b);Ma(a,b);e.css({display:b.open?"block":"none"});if(b.isParent){c.bind("click",{treeObjId:a.treeObjId,treeNode:b},P);d.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},P)}d.bind("click",function(){var j=true;if(typeof a.callback.beforeClick=="function")j=a.callback.beforeClick(a.treeObjId,b);if(j!=false){window.getSelection?window.getSelection().removeAllRanges():
document.selection.empty();L(a,b);a.treeObj.trigger(ia,[a.treeObjId,b])}});g.bind("mousedown",function(){b.editNameStatus=false});if(a.checkable){c.after("<BUTTON type='BUTTON' ID='"+b.tId+$+"' onfocus='this.blur();' ></BUTTON>");var i=f("#"+b.tId+$);if(a.checkStyle==Na&&a.checkRadioType==hb&&b[a.checkedCol])a.checkRadioCheckedList=a.checkRadioCheckedList.concat([b]);Q(a,i,b);i.bind("click",function(){var j=true;if(typeof a.callback.beforeChange=="function")j=a.callback.beforeChange(a.treeObjId,b);
if(j!=false){b[a.checkedCol]=!b[a.checkedCol];Q(a,i,b);a.treeObj.trigger(ja,[a.treeObjId,b])}});i.bind("mouseover",function(){b.checkboxFocus=true;Q(a,i,b)});i.bind("mouseout",function(){b.checkboxFocus=false;Q(a,i,b)})}Oa(b);Pa(a,b);d.hover(function(){Qa(a,b)},function(){a.curTreeNode!=b&&aa(a,b)});d.bind("mousedown",function(j){if(!(j.button==2||!a.editable)){var r=document,q,o,k,u=false,h=a,R=null,M=null,p=null,y=x,ib=j.clientX,jb=j.clientY,Ra=(new Date).getTime();f(r).mousemove(function(l){if(b.editNameStatus)return true;
window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();if(a.dragStatus==0&&Math.abs(ib-l.clientX)<Sa&&Math.abs(jb-l.clientY)<Sa)return true;f("body").css("cursor","pointer");f("#"+b.tId+z);if(a.dragStatus==0&&b.isParent&&b.open){G(a,b,!b.open);a.dragNodeShowBefore=true}if(a.dragStatus==0){a.dragStatus=-1;var m=true;if(typeof a.callback.beforeDrag=="function")m=a.callback.beforeDrag(a.treeObjId,b);if(m==false)return;a.dragStatus=1;Ta(true);L(a,b);aa(a,b);m=f("#"+b.tId).clone();
m.attr("id",b.tId+"_tmp");m.css("padding","0");m.children("#"+b.tId+n).removeClass(sa);m.children("#"+b.tId+v).css("display","none");q=f("<ul class='zTreeDragUL'></ul>").append(m);q.attr("id",b.tId+v+"_tmp");q.addClass(a.treeObj.attr("class"));q.appendTo("body");o=f("<button class='tmpzTreeMove_arrow'></button>");o.attr("id","zTreeMove_arrow_tmp");o.appendTo("body");a.treeObj.trigger(la,[a.treeObjId,b])}if(a.dragStatus==1&&o.attr("id")!=l.target.id){if(k){k.removeClass(ta);p&&f("#"+p+n,k).removeClass(ua)}p=
k=null;u=false;h=a;for(var B in E)if(E[B].editable&&E[B].treeObjId!=a.treeObjId&&(l.target.id==E[B].treeObjId||f(l.target).parents("#"+E[B].treeObjId).length>0)){u=true;h=E[B]}B=f(r).scrollTop();m=f(r).scrollLeft();var C=h.treeObj.offset(),va=h.treeObj.get(0).scrollHeight,w=h.treeObj.get(0).scrollWidth,s=l.clientY+B-C.top,H=h.treeObj.height()+C.top-l.clientY-B,I=l.clientX+m-C.left;C=h.treeObj.width()+C.left-l.clientX-m;s=s<10&&s>-5;H=H<10&&H>-5;I=I<10&&I>-5;C=C<10&&C>-5;var kb=s&&h.treeObj.scrollTop()<=
0;va=H&&h.treeObj.scrollTop()+h.treeObj.height()+10>=va;var lb=I&&h.treeObj.scrollLeft()<=0;w=C&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=w;if(l.target.id&&h.treeObj.find("#"+l.target.id).length>0){for(var A=f("#"+l.target.id);!A.is("li")&&A.attr("id")!=h.treeObjId;)A=A.parent();var wa=false;if(b.parentNode&&A.attr("id")!=b.tId&&f("#"+b.tId).find("#"+A.attr("id")).length==0)wa=true;else if(b.parentNode==null&&A.attr("id")!=b.tId&&f("#"+b.tId).find("#"+A.attr("id")).length==0)wa=true;if(wa)if(l.target.id&&
(l.target.id==A.attr("id")+n||f(l.target).parents("#"+A.attr("id")+n).length>0)){k=A;p=A.attr("id");f("#"+p+n,k).addClass(ua)}}if(l.target.id==h.treeObjId||f(l.target).parents("#"+h.treeObjId).length>0){if(!k&&(kb||va||lb||w)&&(u||!u&&b.parentNode!=null)){k=h.treeObj;k.addClass(ta)}if(s)h.treeObj.scrollTop(h.treeObj.scrollTop()-10);else H&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10);if(I)h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10);else C&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10);k&&k!=
h.treeObj&&k.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+k.offset().left-h.treeObj.offset().left)}q.css({top:l.clientY+B+3+"px",left:l.clientX+m+3+"px"});s=m=0;if(k&&k.attr("id")!=h.treeObjId){w=p==null?null:T(h,p);m=f("#"+b.tId);s=m.prev().attr("id")==p;m=m.next().attr("id")!=p;s=!s;w=!(b.parentNode&&b.parentNode.tId==p)&&!(h.keepLeaf&&!w.isParent);H=m?w?0.25:s?0.5:1:-1;I=s?w?0.75:m?0.5:0:-1;w=f("#"+p+n,k);l=(l.clientY+B-w.offset().top)/w.height();if((H==1||
l<=H&&l>=-0.2)&&m){m=1-o.width();s=0-o.height()/2;y=V}else if((I==0||l>=I&&l<=1.2)&&s){m=1-o.width();s=w.height()-o.height()/2;y=ba}else{m=5-o.width();s=0;y=x}o.css({display:"block",top:w.offset().top+s+"px",left:w.offset().left+m+"px"});if(R!=p||M!=y)Ra=(new Date).getTime();if(y==x)window.moveTimer=setTimeout(function(){if(y==x){var ca=T(h,p);ca&&ca.isParent&&!ca.open&&(new Date).getTime()-Ra>500&&xa(h,ca)}},600)}else{y=x;o.css({display:"none"});window.moveTimer&&clearTimeout(window.moveTimer)}R=
p;M=y}return false});f(r).mouseup(function(){this.moveTimer&&clearTimeout(this.moveTimer);M=R=null;f(r).unbind("mousemove");f(r).unbind("mouseup");f("body").css("cursor","auto");if(k){k.removeClass(ta);p&&f("#"+p+n,k).removeClass(ua)}Ta(false);if(a.dragStatus!=0){a.dragStatus=0;if(b.isParent&&a.dragNodeShowBefore&&!b.open){G(a,b,!b.open);a.dragNodeShowBefore=false}q&&q.remove();o&&o.remove();if(k&&p&&b.parentNode&&p==b.parentNode.tId&&y==x)k=null;if(k){var l=p==null?null:T(h,p),m=true;if(typeof h.callback.beforeDrop==
"function")m=h.callback.beforeDrop(h.treeObjId,b,l,y);if(m!=false){if(u){ya(a,b);da(h,null,[b],false);za(h,l,b,y);L(h,b)}else za(h,l,b,y);f("#"+b.tId+t).focus().blur();a.treeObj.trigger(Z,[h.treeObjId,b,l,y])}}else a.treeObj.trigger(Z,[a.treeObjId,null,null,null])}});j.preventDefault&&j.preventDefault()}});typeof a.addDiyDom=="function"&&a.addDiyDom(a.treeObjId,b);a.treeObj.trigger(ha,[a.treeObjId,b])}function mb(a,b){if(a.setSelectionRange){a.focus();a.setSelectionRange(b,b)}else if(a.createTextRange){var c=
a.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",b);c.select()}}function Ta(a){for(;ea.length>0;){ea[0].remove();ea.shift()}if(a){a=f("iframe");for(var b=0;b<a.length;b++){var c=a.get(b),d;d=Array(2);oRect=c.getBoundingClientRect();d[0]=oRect.left;d[1]=oRect.top;c=f("<div id='zTreeMask_"+b+"' class='zTreeMask' style='top:"+d[1]+"px; left:"+d[0]+"px; width:"+c.offsetWidth+"px; height:"+c.offsetHeight+"px;'></div>");c.appendTo("body");ea.push(c)}}}function La(a,
b){f("#"+b.tId+K).text(b[a.nameCol])}function Oa(a){f("#"+a.tId+n).attr("target",a.target||"_blank")}function Pa(a,b){var c=f("#"+b.tId+n);b.url&&!a.editable?c.attr("href",b.url):c.removeAttr("href")}function F(a,b){if(b){var c=f("#"+b.tId+z);f("#"+b.tId+n);var d=f("#"+b.tId+v),e=f("#"+b.tId+t);c.attr("class","switch");if(a.showLine){if(b.level==0&&b.isFirstNode&&b.isLastNode)c.attr("class","switch_"+Aa);else if(b.level==0&&b.isFirstNode)c.attr("class","switch_"+Ba);else b.isLastNode?c.attr("class",
"switch_"+fa):c.attr("class","switch_"+Ua);b.isLastNode?d.removeClass(Ca):d.addClass(Ca)}else c.attr("class","switch_"+Va);d=b.open?"_"+N:"_"+O;c.attr("class",b.isParent?c.attr("class")+d:c.attr("class")+"_"+J);if(!b.isAjaxing){e.attr("class",b.iconSkin?b.iconSkin:"");e.addClass(b.isParent?"ico"+d:"ico_"+J);c="";if(b.icon)c+="background:url("+b.icon+") 0 0 no-repeat;";if(a.showIcon==false||typeof a.showIcon=="function"&&!a.showIcon(a.treeObjId,b))c+="width:0px;height:0px;";c!=""?e.attr("style",c):
e.attr("style","")}}}function Ma(a,b){var c=f("#"+b.tId+n),d={};(d=typeof a.fontCss=="function"?a.fontCss(a.treeObjId,b):a.fontCss)&&c.css(d)}function D(a,b){if(a){var c=a.attr("class");if(c!=undefined){c=c.split("_");switch(b){case Aa:case Ba:case Ua:case fa:case Va:c[1]=b;break;case N:case O:case J:c[2]=b}a.attr("class",c.join("_"))}}}function S(a,b,c){if(!(!b||a.isAjaxing)){a=b.attr("class");if(a!=undefined){a=a.split("_");switch(c){case N:case O:case J:a[1]=c}b.attr("class",a.join("_"))}}}function Qa(a,
b){if(a.dragStatus==0){b.isHover=true;if(a.editable){nb(a,b);ob(a,b)}typeof a.addHoverDom=="function"&&a.addHoverDom(a.treeObjId,b)}}function aa(a,b){b.isHover=false;f("#"+b.tId+ga).unbind().remove();f("#"+b.tId+W).unbind().remove();typeof a.removeHoverDom=="function"&&a.removeHoverDom(a.treeObjId,b)}function nb(a,b){if(!(b.editNameStatus||f("#"+b.tId+ga).length>0)){var c=a.edit_renameBtn;if(typeof a.edit_renameBtn=="function")c=a.edit_renameBtn(b);if(c){f("#"+b.tId+n);f("#"+b.tId+K).after("<button type='button' class='edit' id='"+
b.tId+ga+"' title='' onfocus='this.blur();' style='display:none;'></button>");f("#"+b.tId+ga).bind("click",function(){var d=true;if(typeof a.callback.beforeRename=="function")d=a.callback.beforeRename(a.treeObjId,b);if(d!=false){aa(a,b);b.editNameStatus=true;L(a,b);return false}}).bind("mousedown",function(){return true}).show()}}}function ob(a,b){if(!(!a.edit_removeBtn||f("#"+b.tId+W).length>0)){var c=a.edit_removeBtn;if(typeof a.edit_removeBtn=="function")c=a.edit_removeBtn(b);if(c){f("#"+b.tId+
n).append("<button type='button' class='remove' id='"+b.tId+W+"' title='' onfocus='this.blur();' style='display:none;'></button>");f("#"+b.tId+W);f("#"+b.tId+W).bind("click",function(){var d=true;if(typeof a.callback.beforeRemove=="function")d=a.callback.beforeRemove(a.treeObjId,b);if(d!=false){ya(a,b);a.treeObj.trigger(ka,[a.treeObjId,b]);return false}}).bind("mousedown",function(){return true}).show()}}}function Q(a,b,c){if(b){b.removeClass();a=a.checkStyle+"_"+(c[a.checkedCol]?pb:qb)+"_"+(c[a.checkedCol]||
a.checkStyle==Na?c.check_True_Full?Wa:Xa:c.check_False_Full?Wa:Xa);a=c.checkboxFocus?a+"_"+rb:a;b.addClass(sb);b.addClass(a)}}function Ya(a,b){if(b)for(var c=0;c<b.length;c++){var d=b[c];d[a.checkedCol]=false;var e=f("#"+d.tId+$);Q(a,e,d);Ya(a,d[a.nodesCol])}}function P(a){var b=E[a.data.treeObjId];a=a.data.treeNode;if(a.open){var c=true;if(typeof b.callback.beforeCollapse=="function")c=b.callback.beforeCollapse(b.treeObjId,a)}else{c=true;if(typeof b.callback.beforeExpand=="function")c=b.callback.beforeExpand(b.treeObjId,
a)}if(c==false)return;b.expandTriggerFlag=true;xa(b,a)}function xa(a,b){if(b.open||b&&b[a.nodesCol]&&b[a.nodesCol].length>0)G(a,b,!b.open);else if(a.async){var c=true;if(typeof a.callback.beforeAsync=="function")c=a.callback.beforeAsync(a.treeObjId,b);c==false?G(a,b,!b.open):Da(a,b)}else b&&G(a,b,!b.open)}function Da(a,b){if(!(b&&(b.isAjaxing||!b.isParent))){if(b){b.isAjaxing=true;f("#"+b.tId+t).attr("class","ico_loading")}for(var c="",d=0;b&&d<a.asyncParam.length;d++)c+=(c.length>0?"&":"")+a.asyncParam[d]+
"="+b[a.asyncParam[d]];if(Object.prototype.toString.apply(a.asyncParamOther)==="[object Array]")for(d=0;d<a.asyncParamOther.length;d+=2)c+=(c.length>0?"&":"")+a.asyncParamOther[d]+"="+a.asyncParamOther[d+1];else for(var e in a.asyncParamOther)c+=(c.length>0?"&":"")+e+"="+a.asyncParamOther[e];d=a.asyncUrl;if(typeof a.asyncUrl=="function")d=a.asyncUrl(b);f.ajax({type:"POST",url:d,data:c,success:function(g){var i=[];try{i=!g||g.length==0?[]:typeof g=="string"?eval("("+g+")"):g}catch(j){}if(b)b.isAjaxing=
undefined;F(a,b);i&&i!=""?da(a,b,i,false):da(a,b,[],false);a.treeObj.trigger(oa,[a.treeObjId,b,g])},error:function(g,i,j){a.expandTriggerFlag=false;F(a,b);if(b)b.isAjaxing=undefined;a.treeObj.trigger(pa,[a.treeObjId,b,g,i,j])}})}}function G(a,b,c,d,e){if(!b||b.open==c)typeof e=="function"&&e();else{if(a.expandTriggerFlag){e=function(){b.open?a.treeObj.trigger(ma,[a.treeObjId,b]):a.treeObj.trigger(na,[a.treeObjId,b])};a.expandTriggerFlag=false}c=f("#"+b.tId+z);var g=f("#"+b.tId+t),i=f("#"+b.tId+v);
if(b.isParent)if(b.open){D(c,O);S(b,g,O);b.open=false;if(d==false||a.expandSpeed==""){i.hide();typeof e=="function"&&e()}else i.hide(a.expandSpeed,e)}else{D(c,N);S(b,g,N);b.open=true;if(d==false||a.expandSpeed==""){i.show();typeof e=="function"&&e()}else if(b[a.nodesCol]&&b[a.nodesCol].length>0)i.show(a.expandSpeed,e);else{i.show();typeof e=="function"&&e()}}else typeof e=="function"&&e()}}function Ea(a,b,c,d,e){var g=b?b[a.nodesCol]:a.root[a.nodesCol],i=b?false:d;if(g)for(var j=0;j<g.length;j++)g[j]&&
Ea(a,g[j],c,i);G(a,b,c,d,e)}function X(a,b,c,d,e){if(b)if(b.parentNode){G(a,b,c,d);b.parentNode&&X(a,b.parentNode,c,d,e)}else G(a,b,c,d,e)}function Za(a,b,c){if(c){c.level=b?b.level+1:0;if(c[a.nodesCol])for(b=0;b<c[a.nodesCol].length;b++)c[a.nodesCol][b]&&Za(a,c,c[a.nodesCol][b])}}function da(a,b,c,d){if(!(a.keepLeaf&&b&&!b.isParent)){if(a.isSimpleData)c=Fa(a,c);if(b){if(a.treeObj.find("#"+b.tId).length!=0){target_switchObj=f("#"+b.tId+z);target_icoObj=f("#"+b.tId+t);target_aObj=f("#"+b.tId+n);target_ulObj=
f("#"+b.tId+v);if(!b.open){D(target_switchObj,O);S(b,target_icoObj,O);b.open=false;target_ulObj.css({display:"none"})}if(!b.isParent){target_switchObj.unbind("click");target_switchObj.bind("click",{treeObjId:a.treeObjId,treeNode:b},P);target_aObj.unbind("dblclick");target_aObj.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},P)}$a(a,b,c);U(a,b.level+1,c,b);d||X(a,b,true)}}else{$a(a,a.root,c);U(a,0,c,null)}}}function $a(a,b,c){b[a.nodesCol]||(b[a.nodesCol]=[]);if(b[a.nodesCol].length>0){b[a.nodesCol][b[a.nodesCol].length-
1].isLastNode=false;F(a,b[a.nodesCol][b[a.nodesCol].length-1])}b.isParent=true;b[a.nodesCol]=b[a.nodesCol].concat(c)}function za(a,b,c,d,e){if(b!=c)if(!(a.keepLeaf&&b&&!b.isParent&&d==x)){var g=c.parentNode==null?a.root:c.parentNode,i=b===null||b==a.root;if(i&&b===null)b=a.root;if(i)d=x;var j=b.parentNode?b.parentNode:a.root;if(d!=V&&d!=ba)d=x;var r=-1,q=0,o=null,k=null;if(c.isFirstNode){r=0;if(g[a.nodesCol].length>1){o=g[a.nodesCol][1];o.isFirstNode=true}}else if(c.isLastNode){r=g[a.nodesCol].length-
1;o=g[a.nodesCol][r-1];o.isLastNode=true}else for(var u=0;u<g[a.nodesCol].length;u++)if(g[a.nodesCol][u].tId==c.tId)r=u;r>=0&&g[a.nodesCol].splice(r,1);if(d!=x)for(u=0;u<j[a.nodesCol].length;u++)if(j[a.nodesCol][u].tId==b.tId)q=u;r=false;if(d==x){if(i)c.parentNode=null;else{r=!b.isParent;b.isParent=true;c.parentNode=b}b[a.nodesCol]||(b[a.nodesCol]=[]);if(b[a.nodesCol].length>0){k=b[a.nodesCol][b[a.nodesCol].length-1];k.isLastNode=false}b[a.nodesCol].splice(b[a.nodesCol].length,0,c);c.isLastNode=true;
c.isFirstNode=b[a.nodesCol].length==1}else if(b.isFirstNode&&d==V){j[a.nodesCol].splice(q,0,c);k=b;k.isFirstNode=false;c.parentNode=b.parentNode;c.isFirstNode=true;c.isLastNode=false}else if(b.isLastNode&&d==ba){j[a.nodesCol].splice(q+1,0,c);k=b;k.isLastNode=false;c.parentNode=b.parentNode;c.isFirstNode=false;c.isLastNode=true}else{d==V?j[a.nodesCol].splice(q,0,c):j[a.nodesCol].splice(q+1,0,c);c.parentNode=b.parentNode;c.isFirstNode=false;c.isLastNode=false}Ja(a,c);Za(a,c.parentNode,c);f("#"+c.tId+
z);f("#"+c.tId+v);var h,R,M;if(i)q=j=a.treeObj;else{j=f("#"+b.tId);h=f("#"+b.tId+z);R=f("#"+b.tId+t);M=f("#"+b.tId+n);q=f("#"+b.tId+v)}if(d==x){D(h,N);S(b,R,N);b.open=true;q.css({display:"block"});if(r&&!i){h.unbind("click");h.bind("click",{treeObjId:a.treeObjId,treeNode:b},P);M.unbind("dblclick");M.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},P)}q.append(f("#"+c.tId).detach())}else if(d==V)j.before(f("#"+c.tId).detach());else d==ba&&j.after(f("#"+c.tId).detach());F(a,c);if(!a.keepParent&&g[a.nodesCol].length<
1){g.isParent=false;b=f("#"+g.tId+v);d=f("#"+g.tId+z);i=f("#"+g.tId+t);D(d,J);S(g,i,J);b.css("display","none")}else o&&F(a,o);k&&F(a,k);X(a,c.parentNode,true,e)}}function Ja(a,b){if(a.isSimpleData)b[a.treeNodeParentKey]=b.parentNode?b.parentNode[a.treeNodeKey]:a.rootPID}function ya(a,b){var c=b.parentNode==null?a.root:b.parentNode;if(a.curTreeNode===b)a.curTreeNode=null;if(a.curEditTreeNode===b)a.curEditTreeNode=null;f("#"+b.tId).remove();for(var d=-1,e=0;e<c[a.nodesCol].length;e++)if(c[a.nodesCol][e].tId==
b.tId)d=e;d>=0&&c[a.nodesCol].splice(d,1);if(!a.keepParent&&c[a.nodesCol].length<1){c.isParent=false;c.open=false;d=f("#"+c.tId+v);e=f("#"+c.tId+z);var g=f("#"+c.tId+t);D(e,J);S(c,g,J);d.css("display","none")}else if(a.showLine&&c[a.nodesCol].length>0){c[a.nodesCol][c[a.nodesCol].length-1].isLastNode=true;c[a.nodesCol][c[a.nodesCol].length-1].isFirstNode=c[a.nodesCol].length==1;d=f("#"+c[a.nodesCol][c[a.nodesCol].length-1].tId+v);e=f("#"+c[a.nodesCol][c[a.nodesCol].length-1].tId+z);f("#"+c[a.nodesCol][c[a.nodesCol].length-
1].tId+t);if(c==a.root)if(c[a.nodesCol].length==1)D(e,Aa);else{c=f("#"+c[a.nodesCol][0].tId+z);D(c,Ba);D(e,fa)}else D(e,fa);d.removeClass(Ca)}}function T(a,b){return Ga(a,a.root[a.nodesCol],"tId",b)}function Ga(a,b,c,d){if(!b||!c)return null;for(var e=0;e<b.length;e++){if(b[e][c]==d)return b[e];var g=Ga(a,b[e][a.nodesCol],c,d);if(g)return g}return null}function ab(a,b,c,d){if(!b||!c)return[];for(var e=[],g=0;g<b.length;g++){b[g][c]==d&&e.push(b[g]);e=e.concat(ab(a,b[g][a.nodesCol],c,d))}return e}
function bb(a,b,c,d){if(!b||!c)return[];for(var e=[],g=0;g<b.length;g++){typeof b[g][c]=="string"&&b[g][c].indexOf(d)>-1&&e.push(b[g]);e=e.concat(bb(a,b[g][a.nodesCol],c,d))}return e}function cb(a){if(a.curTreeNode){f("#"+a.curTreeNode.tId+n).removeClass(sa);f("#"+a.curTreeNode.tId+K).text(a.curTreeNode[a.nameCol]);aa(a,a.curTreeNode);a.curTreeNode=null}}function tb(a){if(a.curEditTreeNode){f("#"+a.curEditTreeNode.tId+n).removeClass(db);f("#"+a.curEditTreeNode.tId+Ha).unbind();f("#"+a.curEditTreeNode.tId+
K).text(a.curEditTreeNode[a.nameCol]);a.curEditTreeNode.editNameStatus=false;a.curEditTreeNode=null}}function L(a,b){if(!(a.curTreeNode==b&&!b.editNameStatus)){cb(a);tb(a);if(a.editable&&b.editNameStatus){f("#"+b.tId+K).html("<input type=text class='rename' id='"+b.tId+Ha+"'>");var c=f("#"+b.tId+Ha);c.attr("value",b[a.nameCol]);c.focus();mb(c.get(0),b[a.nameCol].length);c.bind("blur",function(){b[a.nameCol]=this.value;a.treeObj.trigger(Y,[a.treeObjId,b]);L(a,b)}).bind("keypress",function(d){if(d.keyCode==
"13"){b[a.nameCol]=this.value;a.treeObj.trigger(Y,[a.treeObjId,b]);L(a,b)}}).bind("click",function(){return false}).bind("dblclick",function(){return false});f("#"+b.tId+n).addClass(db);a.curEditTreeNode=b}else f("#"+b.tId+n).addClass(sa);Qa(a,b);a.curTreeNode=b}}function eb(a,b,c){if(!b)return[];for(var d=[],e=0;e<b.length;e++){if(b[e][a.checkedCol]==c)d=d.concat([b[e]]);var g=eb(a,b[e][a.nodesCol],c);if(g.length>0)d=d.concat(g)}return d}function fb(a,b){if(!b)return[];for(var c=[],d=0;d<b.length;d++){if(b[d][a.checkedCol]!=
b[d].checkedOld)c=c.concat([b[d]]);var e=fb(a,b[d][a.nodesCol]);if(e.length>0)c=c.concat(e)}return c}function Fa(a,b){var c=a.treeNodeKey,d=a.treeNodeParentKey;if(!c||c==""||!b)return[];if(Object.prototype.toString.apply(b)==="[object Array]"){for(var e=[],g=[],i=0;i<b.length;i++)g[b[i][c]]=b[i];for(i=0;i<b.length;i++)if(g[b[i][d]]){g[b[i][d]][a.nodesCol]||(g[b[i][d]][a.nodesCol]=[]);g[b[i][d]][a.nodesCol].push(b[i])}else e.push(b[i]);return e}else return[b]}function Ia(a,b){if(!b)return[];var c=
[];if(Object.prototype.toString.apply(b)==="[object Array]")for(var d=0;d<b.length;d++){c.push(b[d]);if(b[d][a.nodesCol])c=c.concat(Ia(a,b[d][a.nodesCol]))}else{c.push(b);if(b[a.nodesCol])c=c.concat(Ia(a,b[a.nodesCol]))}return c}function ub(){return{container:null,setting:null,init:function(a){this.container=a;this.setting=E[a.attr("id")];return this},refresh:function(){this.setting.treeObj.empty();this.setting.curTreeNode=null;this.setting.curEditTreeNode=null;this.setting.dragStatus=0;this.setting.dragNodeShowBefore=
false;this.setting.checkRadioCheckedList=[];ra=0;U(this.setting,0,this.setting.root[this.setting.nodesCol])},setEditable:function(a){this.setting.editable=a;return this.refresh()},transformTozTreeNodes:function(a){return Fa(this.setting,a)},transformToArray:function(a){return Ia(this.setting,a)},getNodes:function(){return this.setting.root[this.setting.nodesCol]},getSelectedNode:function(){return this.setting.curTreeNode},getCheckedNodes:function(a){return eb(this.setting,this.setting.root[this.setting.nodesCol],
a!=false)},getChangeCheckedNodes:function(){return fb(this.setting,this.setting.root[this.setting.nodesCol])},getNodeByTId:function(a){if(a)return T(this.setting,a)},getNodeByParam:function(a,b){if(a)return Ga(this.setting,this.setting.root[this.setting.nodesCol],a,b)},getNodesByParam:function(a,b){if(a)return ab(this.setting,this.setting.root[this.setting.nodesCol],a,b)},getNodesByParamFuzzy:function(a,b,c){if(a)return bb(this.setting,c?c[this.setting.nodesCol]:this.setting.root[this.setting.nodesCol],
a,b)},getNodeIndex:function(a){if(a){for(var b=a.parentNode==null?this.setting.root:a.parentNode,c=0;c<b[this.setting.nodesCol].length;c++)if(b[this.setting.nodesCol][c]==a)return c;return-1}},getSetting:function(){var a=this.setting,b={checkType:{},callback:{}},c=a.checkType;a.checkType=undefined;var d=a.callback;a.callback=undefined;var e=a.root;a.root=undefined;f.extend(b,a);a.checkType=c;a.callback=d;a.root=e;f.extend(true,b.checkType,c);f.extend(b.callback,d);return b},updateSetting:function(a){if(a){var b=
this.setting,c=b.treeObjId,d=a.checkType;a.checkType=undefined;var e=a.callback;a.callback=undefined;var g=a.root;a.root=undefined;f.extend(b,a);a.checkType=d;a.callback=e;a.root=g;f.extend(true,b.checkType,d);f.extend(b.callback,e);b.treeObjId=c;b.treeObj=this.container}},expandAll:function(a){Ea(this.setting,null,a,true)},expandNode:function(a,b,c){if(a){b&&a.parentNode&&X(this.setting,a.parentNode,b,false);if(c)Ea(this.setting,a,b,false,function(){f("#"+a.tId+t).focus().blur()});else if(a.open!=
b){xa(this.setting,a);f("#"+a.tId+t).focus().blur()}}},selectNode:function(a){if(a){L(this.setting,a);a.parentNode?X(this.setting,a.parentNode,true,false,function(){f("#"+a.tId+t).focus().blur()}):f("#"+a.tId+t).focus().blur()}},cancleSelectedNode:function(){this.cancelSelectedNode()},cancelSelectedNode:function(){cb(this.setting)},uncheckAllNodes:function(){Ya(this.setting,this.setting.root[this.setting.nodesCol])},reAsyncChildNodes:function(a,b){if(this.setting.async){var c=!a;if(c)a=this.setting.root;
if(b=="refresh"){a[this.setting.nodesCol]=[];c?this.setting.treeObj.empty():f("#"+a.tId+v).empty()}Da(this.setting,c?null:a)}},addNodes:function(a,b,c){if(b){a||(a=null);b=Object.prototype.toString.apply(b)==="[object Array]"?b:[b];da(this.setting,a,b,c==true)}},updateNode:function(a){if(a){var b=f("#"+a.tId+$);this.setting.checkable&&Q(this.setting,b,a);La(this.setting,a);Oa(a);Pa(this.setting,a);F(this.setting,a);Ma(this.setting,a)}},moveNode:function(a,b,c){if(b)if(!(a&&(b.parentNode==a&&c==x||
f("#"+b.tId).find("#"+a.tId).length>0))){a||(a=null);za(this.setting,a,b,c,false)}},removeNode:function(a){a&&ya(this.setting,a)}}}var ha="ZTREE_NODECREATED",ia="ZTREE_CLICK",ja="ZTREE_CHANGE",Y="ZTREE_RENAME",ka="ZTREE_REMOVE",la="ZTREE_DRAG",Z="ZTREE_DROP",ma="ZTREE_EXPAND",na="ZTREE_COLLAPSE",oa="ZTREE_ASYNC_SUCCESS",pa="ZTREE_ASYNC_ERROR",z="_switch",t="_ico",K="_span",Ha="_input",$="_check",ga="_edit",W="_remove",v="_ul",n="_a",Aa="root",Ba="roots",Ua="center",fa="bottom",Va="noLine",Ca="line",
N="open",O="close",J="docu",sa="curSelectedNode",db="curSelectedNode_Edit",ta="tmpTargetTree",ua="tmpTargetNode",Na="radio",sb="chk",qb="false",pb="true",Wa="full",Xa="part",rb="focus",hb="all",x="inner",V="before",ba="after",Sa="5",E=[],ra=0;f.fn.zTree=function(a,b){var c={treeObjId:"",checkable:false,editable:false,edit_renameBtn:true,edit_removeBtn:true,showLine:true,showIcon:true,keepParent:false,keepLeaf:false,curTreeNode:null,curEditTreeNode:null,dragStatus:0,dragNodeShowBefore:false,checkStyle:"checkbox",
checkType:{Y:"ps",N:"ps"},checkRadioType:"level",checkRadioCheckedList:[],async:false,asyncUrl:"",asyncParam:[],asyncParamOther:[],isSimpleData:false,treeNodeKey:"",treeNodeParentKey:"",rootPID:null,nameCol:"name",nodesCol:"nodes",checkedCol:"checked",expandSpeed:"fast",expandTriggerFlag:false,addHoverDom:null,removeHoverDom:null,addDiyDom:null,fontCss:{},root:{isRoot:true,nodes:[]},callback:{beforeAsync:null,beforeClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeChange:null,
beforeDrag:null,beforeDrop:null,beforeRename:null,beforeRemove:null,beforeExpand:null,beforeCollapse:null,nodeCreated:null,click:null,rightClick:null,mouseDown:null,mouseUp:null,change:null,drag:null,drop:null,rename:null,remove:null,expand:null,collapse:null,asyncSuccess:null,asyncError:null}};if(a){var d=a.checkType;a.checkType=undefined;var e=a.callback;a.callback=undefined;var g=a.root;a.root=undefined;f.extend(c,a);a.checkType=d;f.extend(true,c.checkType,d);a.callback=e;f.extend(c.callback,e);
a.root=g;f.extend(c.root,g)}c.treeObjId=this.attr("id");c.treeObj=this;c.root.tId=-1;c.root.name="ZTREE ROOT";c.root.isRoot=true;c.checkRadioCheckedList=[];c.curTreeNode=null;c.curEditTreeNode=null;c.dragNodeShowBefore=false;c.dragStatus=0;c.expandTriggerFlag=false;c.root[c.nodesCol]||(c.root[c.nodesCol]=[]);ra=0;if(b)c.root[c.nodesCol]=b;if(c.isSimpleData)c.root[c.nodesCol]=Fa(c,c.root[c.nodesCol]);E[c.treeObjId]=c;c.treeObj.empty();gb(c,this);if(c.root[c.nodesCol]&&c.root[c.nodesCol].length>0)U(c,
0,c.root[c.nodesCol]);else c.async&&c.asyncUrl&&c.asyncUrl.length>0&&Da(c);return(new ub).init(this)};var ea=[]})(jQuery);
